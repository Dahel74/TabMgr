/**-----------------------------------------------------------------------------------------------------------------------------------
 ** @brief	Ce ficher crée toutes les tables nécessaire à l exécution de Heredis.
 ** @detail	Pour toutes modification apporté à ce fichier il faut mettre à jour le numéro de révision de la base de donnée
 **			celui-ci est la valeur par défaut assigné à DatabaseVersion de la table de Preferences.
 **			Ensuite, pour s assurer que les données restent cohérentes, vous devez aller dans le fichier de la lib HLibRepairCallback
 **			Ajoutez votre methodes ici. Elle doit avoir la siganture (*RepairFunctionT) SQLiteDatabase* aConnection, int fromVersion, int toVersion
 **			ou aConnection est le fichier qui vient d être ouvert et qui est à convertir, fromVersion est la version du fichier et
 **			toVersion est la version du programme actuelle. La Signature de cette fonction doit être en C.
 **			Ensuite il faut ajouter cette methode dans le tableau des methodes de conversion smUpdateFunctions un peu plus bas. Ajouter votre fonction à la fin 
 **			afin que l ordre de conversion reste correct. Toujours laisser la valeur nil en dernier.
 **
 **         Attention : le nom des tables ne doit jamais comporter un _ (réservé pour les tables systéme)
 **         Attention : ne mettre aucune apostrophe dans les commentaires internes aux tables
 **/

/*  liste des modifications sur la base, mettre à jour svp à chaque changement
 *  6  -> suppression du codeID dans la table des NumeroSosa
 *  7  -> suppression du codeID dans les tables :
 *          OrdreEnfants
 *          OrdreUnions
 *          LiensAdresses
 *          LiensTachesIndis
 *          LiensTachesAdresses
 *  8  -> recalcul des champs calculés (tables individus, événements et unions)
 *  9  -> force le recalcul des champs calculés (n a pas été activé dans l alpha16)
 * 10  -> ajout de la table DoublonsExclus qui mémorise les doublons détectés par Heredis comme n étant pas des doublons
 * 11  -> vérification des unions monoparentales manquantes
 * 12  -> Correction des exeptions de prénoms
 * 13  -> nettoyage de la table de preference et des champs utilisateurs
 * 14  -> Ajout des champs d identification supplémentaire pour les lieux (latitude, logitude, ...)
 * 15  -> force le recalcul des champs professions (intégration de la base de profession US)
 * 16  -> Ajout des triggers pour les champs calculés
 * 17  -> Localisation des lieux déjà présents dans la base
 * 18  -> Correction sur les dates mal enregistrées dans la saisie de groupe
 * 19  -> Ajout des triggers sur la date de modification des individus
 * 20  -> Recopie les médias dans le bundle
 * 21  -> Ajout de la liste des particules dans la tables des préférences pour compatibilité avec le PC
 * 22  -> Modification des noms des fichiers des médias dans le bundle pour compatibilité Windows
 * 23  -> Ne pas utiliser, passer directement à 24. 23 est utilisé pour passer une moulinette à la 22 sans changer de numéro de version.
 * 100 -> Passage en version suppérieur de Heredis. Bloque la compatibilité
 * 101 -> Table Lieux / champ Ville : remplacement des chaînes vides par "?"
 * 102 -> Table Notes : moulinette pour mettre le bon type pour les notes de source (elles étaient enregistrées avec le type Lieu)
 * 103 -> Ajout des tables LogsRechercheEnLigne et BranchesMemorisees
 * 104 -> Mise à jour des triggers
 * 105 -> correction du trigger ComputeNoteIndividuInsert pour gestion des types de notes
 * 106 -> 105, suite
 * 107 -> - Table Lieux : recalcul du champ UCD pour la ville
          - Table Notes : recalcul du champ TypeNote
 * 108 -> Moulinette sur les dates de tri de la table Individus, pour les fichiers venant du PC avant la version 14.
 * 200 -> Passage en version 4 de Heredis :
        - Table MediasCadres
        - Date utilisation lieu
 * 201 -> Table Evenements : ajout du boolen Shared
 * 202 -> Intégration des médias haute résolution
 * 203 -> Ne pas utiliser, passer directement à 204. 203 est utilisé pour passer une moulinette à la 202 sans changer de numéro de version.
 *      - Moulinette de correction des champs UCD
 *       - Moulinette de nettoyage de la table Notes
 * 300 -> Passage en version 5 de Heredis
 * 301 -> Moulinette sur les heures pour les forcer en HH:MM
 * 302 -> Ajout fullText sur les notes + moulinette à la conversion
 * 303 -> Ajout des guillemets dans le champ Prenoms de la table Individus pour les prénoms usuels
 * 304 -> Remplit le champ DateTri de la table Sources à partir du champ DateGed
 * 305 -> Remplacement dans la table OrdreUnions du CodeID conjoint par le CodeID union
 * 306 -> Remplit les champs DateTri de la table Individus à partir des Evenements
 * 307 -> Extrait les images contenues dans les notes
 * 308 -> Remplacement des dates des tâches en text (DateEcheanceGed et DateAlerteGed) par des dates timestamp (DateEcheance et DateAlerte)
 * 309 -> Calcul de champs non exportés par la PC. Table Unions : AgeUnionEpouxTri et AgeUnionEpouseTri. Table Evenements : TriTitreUCD.
 * 310 -> Passage des Numeros Sosa en text
 * 311 -> Recupération des CodeUnionParents vides et création le cas echéant des unions manquantes
 * 312 -> Supression des unions monoparentaux multiples crées par le convertisseur
 * 313 -> Suppression des liens médias dont le xrefProprietaire est 0
 * 314 -> Vérification des unions
 * 315 -> Vérification des date tri et age tri
 * 316 -> Suppression des LiensPrenoms supperflus
 * 317 -> Suppression des LiensProfessionIndi supperflus
 * 318 -> Correction sur le champ de Tri des noms
 * 319 -> Correction sur le champ NombreEnfants de la table Unions
 * 320 -> Mise a jour des Triggers: Séparation des triggers de calculs et de mise à jour de la date de modification
 * 321 -> Table notes : recalcul du champ TypeNote
 * 322 -> Table Evénements : correction des dates invalides
 * 323 -> Table Individus/Unions : mainEvents pointant sur un événement absent de la table Evénements
 * 324 -> Particules Reencodage en UTF-8 et formatage sans double quotes
 * 325 -> Verification et nettoyage de l integrité des tables de liens
 * 326 -> Table Sources : repositoryUCD non renseigné sur anciens fichiers PC convertis pour Mac
 * 327 -> Suppression des doublons de LiensSources crées par la saisie sur acte 
 * 328 -> Correction du formatage UUID  
 * 330 -> Force la convertion des IndividusFullText.XrefIndividu en Integer
 * 331 -> Correction CodeUnionParents ne pointant pas sur une union existante
 * 332 -> On recalcule les champs calculés
 * 333 -> Table Unions : CodeMainEventMariage suite à export Heredis
 * 334 -> Table Lieux : correction sur les champs UCD
 * 335 -> Table Préférences : correction sur le champ DateCreation
 * 336 -> Suppression des unions mono fantômes, suite à un bug de la saisie sur acte
 * 337 -> Correction sur les conversion des cadre faites par la PC 17.1
 * 338 -> Restaure la valeur par defaut des timestamps de la table Medias pour DateModiFile et DateUtilisation
 * 339 -> Change la valeur du page_size à 4096 et fait un vacuum
 * 340 -> Table Unions : suppression des unions avec Epoux = Epouse = 0
 * 341 -> Reecriture des UCD Noms
 * 342 -> Reecriture des UCD Prénoms
 * 343 -> Reecriture des UCD Lieux
 * 400 -> Passage en version 18 de Heredis
 * 403 -> Conversion rubriques personnelles en facts
 * 404 -> Ajout de champs dans la table LiensSources pour le mode avancé de citations.
 * 405 -> Initialisation du typeProprietaire de la table LiensSources
 * 406 -> Ajout du champ NombreSources dans la table Individus
 * 407 -> Table Repositories + champ XrefRepository dans Sources
 * 408 -> Calcul par trigger du champs TypeProprietaire de la table LiensSources
 * 409 -> Ajout infos pour les médias en ligne dans la table Medias
 * 410 -> Ajout table pour ordre d affichage des rubriques personnelles
 * 411 -> corrections sur la conversion pour les medias en ligne -> 411
 * 412 -> corrections sur la conversion pour les medias en ligne -> 417 
 * 413 -> recalcul du nextId suite à correction sur l id des lieux créés depuis la base Heredis
 * 414 -> recalcul du nextId suite à correction sur l id des lieux créés depuis la base Heredis
 * 415 -> modification et recalcul de l index IndividusFullText qui pouvait être en erreur suite à un import gedcom et ajout du caractere - en token avec changement de tokenizer
 * 416 -> remplacement de mauvaises dates de modification dans les individus par la date du jour
 * 417 -> re-enregistrement des media avec contruction du nom dans le bundle
 * 418 -> recalcul des codeUnionParents pour les individus ayant bien des parents -> 419
 * 419 -> recalcul des hash des medias pour n utiliser que ceux du bundle 
 * 420 -> Nettoyage de NoteRtf de la table Note qui ne sont pas en format rtf
 * 421 -> Reconstruction des note raw depuis les notes rtf
 * 422 -> Ajout des alternates names et de la table de liens prénoms/alternate names
 * 423 -> Ajout table LiensSourcesExternes pour les sources FamilySearch
 * 424 -> Table événements - suppression des codeLieu fantômes
*/

CREATE TABLE Preferences (
  VersionText           char(32) DEFAULT 0,     /* Contiens le numéro de version du programme ayant créé le fichier forme HEREDIS_OSX 0.9.3 ou HEREDIS_PC 13.0, HEREDIS_IOS 0.9.1 ...*/
  IDFichier             integer DEFAULT 0,      /* non utilisé  compatibilite PC*/
  NextID                integer DEFAULT 0,      /* contient l id suivant a assigner à un individu ou objet Heredis */
  Num1Sosa              integer DEFAULT 0,      /* numéro 1 sosa du fichier */
  UserName              text DEFAULT "",        /* nom de l utilisateur, jamais demandé */
  UserComment           text DEFAULT "",        /* commentaire de l utilisateur, jamais demandé */
  UserField             text DEFAULT "",        /* champ supplémentaire de l utilisateur, jamais demandé */
  DateCreation          timestamp DEFAULT 0,    /* date de création du fichier */    
  DateModification      timestamp DEFAULT 0,    /* date de modification du fichier */
  LocalisationEvent		text DEFAULT "",        /* langue pour la localisation des événements */
  Signature				text DEFAULT "",        /* signature de la base : calculé à la sauvegarde */
  GUID					text DEFAULT "",        /* UUID unique pour ce fichier */
  LastModifier          char(32) DEFAULT 0,     /* Contiens le numéro de version du programme ayant en dernier modifié le fichier */

  DatabaseVersion		integer DEFAULT 424,    /* Numéro de version de la base de donnée. doit être incrémenté à chaque modification de la base, pensez egalement a mettre a jour le commentaire listant les modifications */
  Particules            text DEFAULT ""         /* Pour compatibilité avec le PC */
);

CREATE TABLE Adresses (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  NomsIndividus     text DEFAULT "",
  Adresse1          text DEFAULT "",
  Adresse2          text DEFAULT "",
  CodePostal        text DEFAULT "",
  Ville             text DEFAULT "",
  Pays              text DEFAULT "",
  Departement       text DEFAULT "",
  Adresse1bis       text DEFAULT "",
  Adresse2bis       text DEFAULT "",
  CodePostalbis     text DEFAULT "",
  Villebis          text DEFAULT "",
  Paysbis           text DEFAULT "",
  Departementbis    text DEFAULT "",
  Tel               text DEFAULT "",
  Fax               text DEFAULT "",
  Email             text DEFAULT "",
  Email2            text DEFAULT "",
  PageWeb           text DEFAULT "",
  Private           integer DEFAULT 0,
  TelPro            text DEFAULT "",
  TelPortable       text DEFAULT "",
  Adresse2Activee   boolean  DEFAULT 0
);

CREATE TABLE LiensAdresses (
  IndiPtr			integer DEFAULT NULL,
  AdressePtr		integer DEFAULT NULL
);

CREATE TABLE Evenements (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  CodeProprietaire  integer DEFAULT 0,
  CodeRepository    integer DEFAULT 0,
  EventType         integer DEFAULT 0,
  CodeLieu          integer DEFAULT 0,
  DateTri           double DEFAULT 0.0,
  DateGed           text DEFAULT "",
  TimeGed           text DEFAULT "",
  JourDeLAnnee		integer DEFAULT 0,
  Subdivision       text DEFAULT "",
  SubdivisionUCD    text DEFAULT "",
  Titre             text DEFAULT "",
  TitreUCD          text DEFAULT "",
  TriTitreUCD       text DEFAULT "",
  TriTypeUCD        text DEFAULT "",
  ShowInTypesList   boolean DEFAULT 1,
  AgeSurActe        text DEFAULT "",
  AgeLui            text DEFAULT "",
  AgeElle           text DEFAULT "",
  Cause             text DEFAULT "",
  CauseUCD          text DEFAULT "",
  RechercheActe     integer DEFAULT 0,
  Prive             boolean DEFAULT 0,
  NombreMedias		integer DEFAULT 0,      /* Champs précalculé par code */
  NombreTemoins		integer DEFAULT 0,      /* Champs précalculé par code */
  NombreSources		integer DEFAULT 0,      /* Champs précalculé par code */
  CodeNote			integer DEFAULT 0,       /* Champs précalculé par code */
  Shared            boolean DEFAULT 0
);

CREATE TABLE Individus (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  CodeUnionParents  integer DEFAULT 0,
  CodePere          integer DEFAULT 0,
  CodeMere          integer DEFAULT 0,
  CodeNom           integer DEFAULT 0,
  NomTri            text DEFAULT "",
  Prenoms           text DEFAULT "",
  PrenomsUCD        text DEFAULT "",
  Profession        text DEFAULT "",
  ProfessionUCD     text DEFAULT "",
  Sexe              integer DEFAULT 0,
  Numero            text DEFAULT "",
  SansPosterite     boolean DEFAULT 0,
  Signature         integer DEFAULT 0,
  Filiation         integer DEFAULT 0,
  Marque            boolean DEFAULT 0,
  Confidentiel      boolean DEFAULT 0,
  Secondaire        boolean DEFAULT 0,
  SansAlliance      boolean DEFAULT 0,
  Prefixe           text DEFAULT "",
  PrefixeUCD        text DEFAULT "",  
  Suffixe           text DEFAULT "",
  SuffixeUCD        text DEFAULT "",
  Surnom            text DEFAULT "",
  SurnomUCD         text DEFAULT "",
  Titre             text DEFAULT "",
  TitreUCD          text DEFAULT "",
  FicheComplete     boolean DEFAULT 0,
  FicheCoherente    boolean DEFAULT 0,
  Champ0            text DEFAULT "",
  Champ1            text DEFAULT "",
  Champ2            text DEFAULT "",
  Champ3            text DEFAULT "",
  Champ4            text DEFAULT "",
  Champ5            text DEFAULT "",
  Champ6            text DEFAULT "",
  Champ7            text DEFAULT "",
  Champ8            text DEFAULT "",
  Champ9            text DEFAULT "",
  Champ10            text DEFAULT "",
  Champ11            text DEFAULT "",
  Champ12            text DEFAULT "",
  MainEventNaissanceTri double DEFAULT 100000000000.0,
  MainEventDecesTri double DEFAULT 100000000000.0,
  AgeAuDecesTri		double DEFAULT 0,
  CodeMainEventDeces integer DEFAULT 0,
  CodeMainEventNaissance integer DEFAULT 0,
  NombreUnions		integer DEFAULT 0,      /* Champs précalculé par code */
  NombreEnfants		integer DEFAULT 0,      /* Champs précalculé par code */
  NombreMedias		integer DEFAULT 0,      /* Champs précalculé par code */
  CodeNote			integer DEFAULT 0,      /* Champs précalculé par code */
  NombreSources		integer DEFAULT 0       /* Champs précalculé par code */
);

CREATE VIRTUAL TABLE IndividusFullText USING fts4(
  XrefIndividu      integer PRIMARY KEY,
  PrenomsUCD        text DEFAULT "",
  ProfessionUCD     text DEFAULT "",
  tokenize=unicode61 "tokenchars=-"
);

CREATE TABLE LiensIndividus (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  XrefOrigine       integer DEFAULT 0,
  XrefDestination   integer DEFAULT 0,
  TypeLienIndividu  integer DEFAULT 0,
  Commentaire       text DEFAULT "",
  Age               text DEFAULT "",
  Titre             text DEFAULT "",
  TagType           integer DEFAULT 0
);

CREATE TABLE NumerosSosa (
  CodeIndi			integer PRIMARY KEY ,
  SosaNum			sqlite_int64 DEFAULT 0,
  Multiple			boolean DEFAULT 0,
  FirstSosaNum		sqlite_int64 DEFAULT 0,
  Generation		integer DEFAULT 0,
  CodeDeCujus		integer DEFAULT 0,
  SosaNumStr		text DEFAULT "",
  FirstSosaNumStr	text DEFAULT ""
);

CREATE TABLE NumerosDescendance (
  CodeID			integer PRIMARY KEY,
  NumPelissier		text DEFAULT "",
  NumAboville		text DEFAULT "",
  CodeIndi			integer DEFAULT 0,
  Multiple			boolean DEFAULT 0,
  Generation		integer DEFAULT 0,
  CodeRacine		integer DEFAULT 0
);


CREATE TABLE LiensTachesAdresses (
  TachePtr			integer DEFAULT NULL,
  AdressesPtr		integer DEFAULT NULL
);

CREATE TABLE LiensTachesIndis (
  TachePtr			integer DEFAULT NULL,
  IndisPtr			integer DEFAULT NULL
);

CREATE TABLE Lieux (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  CodeLieu          text DEFAULT "",
  Ville             text DEFAULT "",
  Departement       text DEFAULT "",
  Region            text DEFAULT "",
  Pays              text DEFAULT "",
  CodeLieuUCD       text DEFAULT "",
  VilleUCD          text DEFAULT "",
  DepartementUCD    text DEFAULT "",
  RegionUCD         text DEFAULT "",
  PaysUCD           text DEFAULT "",
  Rattachement      integer DEFAULT 0,
  UppercaseByUser   boolean DEFAULT 0,
  Latitude          double DEFAULT 0.0,
  Longitude         double DEFAULT 0.0,
  IsoCountry        text DEFAULT "",
  InternalCodeLieu  integer DEFAULT 0,       /* code lieu interne */
  DateUtilisation	timestamp DEFAULT 0
);

CREATE TABLE Medias (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  DateModifFile		timestamp DEFAULT 0,
  DateUtilisation	timestamp DEFAULT 0,
  FilePath          text DEFAULT "",
  FilePathUCD		text DEFAULT "",
  FileName          text DEFAULT "",
  FileNameUCD		text DEFAULT "",
  DateGed           text DEFAULT "",
  DateTri           double,
  MediaIntegre      integer DEFAULT 0,
  Private           boolean DEFAULT 0,
  CodeGUID			text DEFAULT "",
  FileSize          integer DEFAULT 0, /* taille du fichier, en octets */
  Uploadable   integer DEFAULT 0, /* savoir si le media peut être mis en ligne, ou sinon pourquoi : 0=pas vérifié, 100=OK, 200=pas de fichier, 201=trop gros, 202=format exclu, 203=pb de calcul du hash */
  Hash              integer DEFAULT 0, /* xxHash32 du fichier, si il peut être envoyé en ligne. Sinon 0. */
  HashOriginal  boolean DEFAULT 0   /* vrai si le hash a été calculé depuis l original, faux si depuis le bundle */
);

CREATE TABLE MediasCadres (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  XrefMediaOrigine  integer DEFAULT 0,  /* id de la photo où on a créé un cadre */
  XrefMediaNewMedia integer DEFAULT 0,  /* id de la photo créée avec le cadre */
  XrefProprietaire  integer DEFAULT 0,  /* id du propriétaire associé au cadre, un individu pour l instant */
  left              double DEFAULT 0,  /* coordonnées des quatres points du retangle dans l image source */
  top               double DEFAULT 0,
  right             double DEFAULT 0,
  bottom            double DEFAULT 0
);

CREATE TABLE LiensMedias (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  XrefMedia         integer DEFAULT 0,
  XrefProprietaire  integer DEFAULT 0,
  Ordre             integer DEFAULT 0,
  Cadre             text DEFAULT "",
  MediaPrincipal    boolean DEFAULT 0
);

CREATE TABLE Notes (
  CodeID            integer PRIMARY KEY,
  CodeProprietaire  integer DEFAULT "",
  TypeNote          integer DEFAULT 0,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  Note              text DEFAULT "",
  NoteRTF           text DEFAULT "",
  NotePrivee        boolean DEFAULT 0
);

CREATE VIRTUAL TABLE NotesFullText USING fts4(
 XrefNote           integer PRIMARY KEY,
 TypeNote           integer DEFAULT 0,
 NoteUCD            text DEFAULT ""
);

CREATE TABLE Noms (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  Nom               text DEFAULT "",
  NomTri            text DEFAULT "",
  NomUCD            text DEFAULT "",
  Rattachement      integer DEFAULT 0,
  UppercaseByUser   boolean DEFAULT 0
);

CREATE TABLE Prenoms (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  Prenom            text DEFAULT "",
  PrenomUCD         text DEFAULT "",
  SexeDefaut        integer DEFAULT 0,
  Rattachement      integer DEFAULT 0,
  UppercaseByUser   boolean DEFAULT 0
);

CREATE TABLE LiensPrenoms (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  XrefIndividu      integer DEFAULT 0,
  XrefPrenom        integer DEFAULT 0,
  Usuel             boolean DEFAULT 0
);

CREATE TABLE Favoris (
  CodeID            integer PRIMARY KEY,
  XrefIndividu      integer DEFAULT 0,       /* Attention, si le favori est un séparateur, le champ est égal à -1 */  
  Titre             text DEFAULT ""
);

CREATE TABLE OrdreEnfants (
  idOrdreEnfants	integer DEFAULT 0
);

CREATE TABLE OrdreUnions (
  idOrdreUnions		integer DEFAULT 0
);

CREATE TABLE Redactions (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  Proprietaire      integer DEFAULT 0,
  Redaction         text DEFAULT "",
  Type              integer DEFAULT 0
);

CREATE TABLE Sources (
  CodeID              integer PRIMARY KEY,
  DateCreation        timestamp DEFAULT 0,
  DateModification    timestamp DEFAULT 0,
  DateUtilisation     timestamp DEFAULT 0,
  TypeSource          integer DEFAULT 0,
  NatureActe          integer DEFAULT 0,
  Certitude           integer DEFAULT 0,
  SourcePrivee        boolean DEFAULT 0,
  Titre               text DEFAULT "",
  Document            text DEFAULT "",
  Cote                text DEFAULT "",
  Archivage           text DEFAULT "",
  Numero              text DEFAULT "",
  Auteur              text DEFAULT "",
  Email               text DEFAULT "",
  Url                 text DEFAULT "",
  DateGED             text DEFAULT "",
  Repository          text DEFAULT "",
  TitreUCD            text DEFAULT "",
  DocumentUCD         text DEFAULT "",
  CoteUCD             text DEFAULT "",
  ArchivageUCD        text DEFAULT "",
  NumeroUCD           text DEFAULT "",
  AuteurUCD           text DEFAULT "",
  RepositoryUCD       text DEFAULT "",
  DateTri             double DEFAULT 0.0,
  XrefRepository      integer DEFAULT 0
);

CREATE TABLE LiensSources (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  XrefProprietaire  integer DEFAULT 0,
  TypeProprietaire  integer DEFAULT 0,
  XrefSource        integer DEFAULT 0,
  Citation          text DEFAULT "",
  Private           boolean DEFAULT 0,
  Quality_Source    integer DEFAULT 0,  /* Original ou copie */
  Quality_Info      integer DEFAULT 0,  /* Source primaire/secondaire */
  Quality_Evidence  integer DEFAULT 0   /* Preuve directe/indirecte */
);

CREATE TABLE Repositories (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  Titre             text DEFAULT "",
  TitreUCD          text DEFAULT "",
  Adresse           text DEFAULT "",
  Telephone         text DEFAULT "",
  Email             text DEFAULT "",
  Url               text DEFAULT ""
);

CREATE TABLE Taches (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  DateEcheanceGed   text DEFAULT "",		/* Deprecié: remplacé par DateEcheance */
  DateEcheance   	timestamp DEFAULT "",
  DateAlerteGed     text DEFAULT "",		/* Deprecié: remplacé par DateAlerte */
  DateAlerte   		timestamp DEFAULT "",
  Titre             text DEFAULT "",
  Description       text DEFAULT "",
  Priorite          integer DEFAULT 0,
  TacheRealisee     boolean DEFAULT 0
);

CREATE TABLE Unions (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  Epoux             integer DEFAULT 0,
  Epouse            integer DEFAULT 0,
  TypeUnion         integer DEFAULT 0,
  TypeUnionUCD      text DEFAULT "",
  StatutUnion       integer DEFAULT 0,
  Confidentiel      boolean DEFAULT 0,
  Champs            text DEFAULT "",
  Marque            boolean DEFAULT 0,
  MainEventMariageTri double DEFAULT 0,
  CodeMainEventMariage integer DEFAULT 0,
  AgeUnionEpouxTri	double DEFAULT 0,
  AgeUnionEpouseTri	double DEFAULT 0,
  NombreEnfants		integer DEFAULT 0,      /* Champs précalculé par code */
  NombreMedias		integer DEFAULT 0,      /* Champs précalculé par code */
  CodeNote			integer DEFAULT 0       /* Champs précalculé par code */
);

CREATE TABLE ChampsUtilisateur (
  NumOrdre          integer DEFAULT 0,
  InUse             boolean DEFAULT 0,
  Intitule          text DEFAULT "",
  Tag				text DEFAULT ""
);

CREATE TABLE Professions (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  NomProfession     text DEFAULT "",
  NomProfessionUCD  text DEFAULT "",
  Rattachement      integer DEFAULT 0
);

CREATE TABLE LiensProfessionsIndi (
  CodeID            integer PRIMARY KEY,
  IndiPtr			integer DEFAULT NULL,
  ProfessionPtr		integer DEFAULT NULL
);

CREATE TABLE MediasVignette (
  CodeID			integer PRIMARY KEY,
  Vignette			blob DEFAULT NULL
);


CREATE TABLE DoublonsExclus (
XrefIndividu1 integer,
XrefIndividu2 integer,
PRIMARY KEY(XrefIndividu1, XrefIndividu2)
);

CREATE TABLE BranchesMemorisees (
  CodeID            integer PRIMARY KEY,
  XrefProprietaire  integer DEFAULT 0,
  TypeBranche       integer DEFAULT 0         /*(enum ascendance, descendance )*/
);

CREATE TABLE LogsRechercheEnLigne (
  CodeID            integer PRIMARY KEY,
  XrefProprietaire  integer DEFAULT 0,        /*(pour le moment un pointeur vers un indi)*/
  Titre             text DEFAULT "",
  URL               text DEFAULT "",
  DateCreation      timestamp DEFAULT 0
);

CREATE TABLE LiensExternes (
  CodeID        integer PRIMARY KEY,
  XrefIndividu    integer DEFAULT 0,
  XternalRef        text DEFAULT "",
  XternalVersion  text DEFAULT "",
  DateCreation      timestamp DEFAULT 0,
  DateConsultation      timestamp DEFAULT 0,
  DateModification      timestamp DEFAULT 0
);

CREATE TABLE OrdreRubriquesPerso (
  Ordre         integer DEFAULT 0,
  TypeRubrique	integer DEFAULT 0
);

CREATE TABLE DatabaseUpgradeLog (
  DateCreation      timestamp DEFAULT 0,
  Log				text DEFAULT "",
  VersionFrom	    integer DEFAULT 0,
  VersionTo	    	integer DEFAULT 0,
  DateStart	    	timestamp DEFAULT 0,
  DateFinish	    timestamp DEFAULT 0,
  Status	    	integer DEFAULT 0
);

CREATE TABLE AlternateNames (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  XrefIndividu      integer DEFAULT 0,
  XrefNom           integer DEFAULT 0,
  Type              integer DEFAULT 0,
  TypeString        text DEFAULT "",
  Prenoms           text DEFAULT "",
  Prefixe           text DEFAULT "",
  Suffixe           text DEFAULT "",
  Surnom            text DEFAULT ""
);

CREATE TABLE LiensAlternateNamesPrenoms (
  CodeID            integer PRIMARY KEY,
  DateCreation      timestamp DEFAULT 0,
  DateModification  timestamp DEFAULT 0,
  XrefAlternateName integer DEFAULT 0,
  XrefPrenom        integer DEFAULT 0,
  Usuel             boolean DEFAULT 0
);

CREATE TABLE LiensSourcesExternes (
CodeID              integer PRIMARY KEY,
XrefSource          integer DEFAULT 0,
XternalRef          text DEFAULT "",
XternalVersion      text DEFAULT "",
DateCreation        timestamp DEFAULT 0,
DateConsultation    timestamp DEFAULT 0,
DateModification    timestamp DEFAULT 0
);
