function utils(controller){this.controller=controller}utils.prototype.mInfoPC=null,utils.prototype.controller=null,utils.prototype.compareIndiModele=null,utils.prototype.removeCookie=function(){$.removeCookie("username"),$.removeCookie("pwd"),$.removeCookie("key128Bits"),$.removeCookie("autoLogin")},utils.prototype.IsConnectedToInternet=function(callback,noInternetCallback){var viewManager=this.controller.getViewManager();this.controller.getHeredisApiCall().testInternetConnexion(function(){callback()},function(){viewManager.disableLoadingText(""),void 0!==noInternetCallback?viewManager.showMsgNoInternet(noInternetCallback):viewManager.showMsgNoInternet()})},utils.prototype.checkIfArgExists=function(obj,arg){return void 0!==obj&&void 0!==obj[arg]?obj[arg]:""},utils.prototype.getInfoIndi=function(data){var response={personID:"",name:"",nom:"",prenom:"",birthLikeDate:"",birthLikePlace:"",deathLikePlace:"",deathLikeDate:"",confidence:"",unionDate:"",numeroLit:"",namePid:"",nameTp:""};if(void 0!==data){var key;if(void 0!==data["heredis-fullStrBirthDatePlace"]&&(response.strBirthPlaceDate=data["heredis-fullStrBirthDatePlace"]),void 0!==data["heredis-fullStrDeathDatePlace"]&&(response.strDeathPlaceDate=data["heredis-fullStrDeathDatePlace"]),void 0!==data.namePid&&(response.namePid=data.namePid),void 0!==data.nameTp&&(response.nameTp=data.nameTp),void 0!==data.idIndi&&(response.personID=data.idIndi),void 0!==data.name&&(response.name=data.name,response.mainName=data.name),void 0!==data.numeroLit&&(response.numeroLit=data.numeroLit),void 0!==data.birthDate&&(response.birthDate=data.birthDate),void 0!==data.birthPlace&&(response.birthPlace=data.birthPlace),void 0===data.birthDate&&void 0===data.birthPlace)"undefined"!==data[key="heredis-christeningDate"]&&(response.birthDate=data[key]),"undefined"!==data[key="heredis-christeningPlace"]&&(response.birthPlace=data[key]);if("undefined"!==data.deathLikeDate&&(response.deathDate=data.deathDate),"undefined"!==data.deathPlace&&(response.deathPlace=data.deathPlace),void 0!==data.unionDate&&(response.unionDate=data.unionDate),void 0!==data["heredis-birthDeathYears"]?response.dateND="("+data["heredis-birthDeathYears"]+")":response.dateND="",void 0===data.deathDate&&void 0===data.deathPlace)"undefined"!==data[key="heredis-burialDate"]&&(response.deathDate=data[key]),"undefined"!==data[key="heredis-burialPlace"]&&(response.deathPlace=data[key]);"undefined"!==data.confidence&&(response.confidence=data.confidence,response.percentConfidence=100*parseInt(response.confidence)/5),"undefined"!==data.score&&(response.score=data.score),"undefined"!==data[key="heredis-gender"]&&(response.gender={63:"../Common/Resources/sexe/iconFe/ico-sex-ind.png",102:"../Common/Resources/sexe/iconFe/ico-sex-fem.png",109:"../Common/Resources/sexe/iconFe/ico-sex-hom.png"}[data[key]])}return response},utils.prototype.getIndiFSFullInfo=function(data){var response={};return null!==data&&void 0!==data.display&&((response=this.getInfoIndi(data.display)).personID=data.id),response},utils.prototype.getInfosPC=function(heredisApiRequester,controller,callback,callbackSupp){var self=this;self.controller.getViewManager();heredisApiRequester.getInfosPCFromLib(function(data){var listIDConjoints="";void 0!==data.conjoints&&data.conjoints.forEach(function(elt,index){index<data.conjoints.length-1?listIDConjoints+=elt.codeId+",":listIDConjoints+=elt.codeId});var infos={codeID:data.codeId,fsid:data.fsid,sexe:data.sexe,dateNDShort:self.checkIfArgExists(data,"strNaisDecesCourtWithPrivate"),givenName:self.checkIfArgExists(data.pc,"prenoms"),surname:self.checkIfArgExists(data.pc,"nom"),tabPcFullIdentity:data.tabPcFullIdentity,tabPcDates:data.tabPcDates,birthLikeDate:self.checkIfArgExists(data.pc,"dateNaissance"),birthLikePlace:self.checkIfArgExists(data.pc,"lieuNaissance"),deathLikeDate:self.checkIfArgExists(data.pc,"dateDeces"),deathLikePlace:self.checkIfArgExists(data.pc,"lieuDeces"),fatherGivenName:self.checkIfArgExists(data.pere,"prenoms"),fatherSurname:self.checkIfArgExists(data.pere,"nom"),motherGivenName:self.checkIfArgExists(data.mere,"prenoms"),motherSurname:self.checkIfArgExists(data.mere,"nom"),spouseGivenName:self.checkIfArgExists(data.conjointSelectionne,"prenoms"),spouseSurname:self.checkIfArgExists(data.conjointSelectionne,"nom"),marriageDate:self.checkIfArgExists(data.conjointSelectionne,"dateUnion"),marriagePlace:self.checkIfArgExists(data.conjointSelectionne,"lieuUnion"),codeIdsSpouses:listIDConjoints};self.mInfoPC=infos,void 0!==callback&&callback(controller,infos,callbackSupp)})},utils.prototype.getPC=function(controller,callback){var heredisApiCall=this.controller.getHeredisApiCall();this.getInfosPC(heredisApiCall,controller,function(controller,infos,callbackSupp){void 0!==callback&&callback(infos)},function(){})},utils.prototype.checkArgForm=function(arg){return void 0!==typeof arg?arg:""},utils.prototype.saveFormSearchPCContent=function(data){localStorage.setItem("PreviousContentSearchPC",JSON.stringify(data))},utils.prototype.getFormPreviousContent=function(){var infos=localStorage.getItem("PreviousContentSearchPC");return JSON.parse(infos)},utils.prototype.saveStateForm=function(value){this.controller.getEncryption().saveItemInCookie("stateForm",value)},utils.prototype.getStateForm=function(){return this.controller.getEncryption().getItemInCookie("stateForm")},utils.prototype.compareIndividu=function(fsGlobalInfo){var heredisApiCall=this.controller.getHeredisApiCall(),self=this;heredisApiCall.getInfosPCFromLib(function(data){var heredisEvents=self.getEventsOfIndi(data);self.compareEvtIndi(fsGlobalInfo.facts,heredisEvents),self.compareRelativesIndi(fsGlobalInfo.links)})},utils.prototype.callbackLogin=function(e){var encryption=this.controller.getEncryption(),viewManager=this.controller.getViewManager();if("true"===encryption.getItemInCookie("autoLogin")&&void 0!==encryption.getItemInCookie("pwd")&&void 0!==encryption.getItemInCookie("username")){var pwd=encryption.decryptPasswdAES128CBC(encryption.getItemInCookie("pwd"),"persistent");encryption.saveInLocalStorage("username",encryption.getItemInCookie("username")),encryption.encryptPasswdAES128CBC(pwd,"session"),viewManager.loginFormModel.set("usernameValue",encryption.getItemInCookie("username")),viewManager.loginFormModel.set("pwdInputValue",pwd),viewManager.loginFormModel.set("RememberIsChecked",!0)}},utils.prototype.submitFormLogin=function(username,pwd,rememberMeIsChecked){var viewManager=this.controller.getViewManager(),encryption=this.controller.getEncryption();""===username||""===pwd||void 0===username||void 0===pwd?viewManager.missingFieldLoginCallback():this.IsConnectedToInternet(function(){viewManager.showLoadingText(""),fsApiClient.oauthPassword(username,pwd,function(error,data){viewManager.disableLoadingText(""),400===data.statusCode?viewManager.errorLoginHandler(["HNLOC_FS_LOGIN_ERROR_MSG_FAILED"]):200===data.statusCode&&(rememberMeIsChecked?(encryption.encryptPasswdAES128CBC(pwd,"persistent"),encryption.saveItemInCookie("autoLogin","true"),encryption.saveItemInCookie("username",username)):rememberMeIsChecked||(encryption.saveItemInCookie("autoLogin","false"),encryption.removeCookieLogin()),encryption.saveInLocalStorage("username",username),encryption.encryptPasswdAES128CBC(pwd,"session"),viewManager.NeedRefreshToken=!1,viewManager.displayMainPageFs())})})},utils.prototype.logoutUser=function(){var self=this,fsApiCall=this.controller.getFsApiCall();this.controller.getEncryption();self.IsConnectedToInternet(function(){fsApiCall.logout(function(){fsApiCall.deleteAccessToken(),fsApiCall.currentUser=null,self.controller.login("")},function(errorCode){var viewManager=self.controller.getViewManager();401===errorCode&&viewManager.refreshToken()})})},utils.prototype.getCurrentUserInfo=function(){var fsApiCall=this.controller.getFsApiCall(),viewManager=this.controller.getViewManager();this.controller.getEncryption();viewManager.showLoadingText(""),fsApiCall.getCurrentUser(function(data){void 0!==data.data.users[0]&&(viewManager.disableLoadingText(""),viewManager.showCurrentUserFsInfo(data.data.users[0]))},function(){console.log("no internet")},function(){viewManager.disableLoadingText(""),viewManager.displayLoginView("",function(){viewManager.errorLoginHandler(["HNLOC_FS_ERROR_MSG_503_PART1","HNLOC_FS_ERROR_MSG_503_PART2"])})})},utils.prototype.getCurrentUserNameAndFsid=function(callback){var viewManager=this.controller.getViewManager(),resp=(this.controller.getEncryption(),{name:"",fsid:""}),fsApiCall=controller.getFsApiCall();viewManager.showLoadingText(""),fsApiCall.getCurrentUser(function(data){viewManager.showLoadingText(""),void 0!==data.data.users&&(resp.name=data.data.users[0].displayName,resp.fsid=data.data.users[0].personId),void 0!==callback&&callback(resp)},function(){console.log("no internet")},function(errorCode){viewManager.showLoadingText(""),viewManager.displayLoginView("",function(){viewManager.errorLoginHandler(["HNLOC_FS_ERROR_MSG_503_PART1","HNLOC_FS_ERROR_MSG_503_PART2"])})})},utils.prototype.refreshToken=function(callback){var encryption=self.controller.getEncryption(),username=encryption.getFromLocalStorage("username"),encryptedpwd=encryption.getFromLocalStorage("pwd"),pwd=encryption.decryptPasswdAES128CBC(encryptedpwd,"session");fsApiClient.oauthPassword(username,pwd,function(error,data){callback()})},utils.prototype.saveItemInCookie=function(name,value){$.cookie(name,value,{expires:365})},utils.prototype.getItemInCookie=function(name){var resp="";return void 0!==$.cookie(name)&&(resp=$.cookie(name)),resp},utils.prototype.unlinkPrimaryPerson=function(codeIdHeredis,callback){var self=this,heredisApi=self.controller.getHeredisApiCall(),strLoc=self.controller.getViewManager().stringsLocalised;heredisApi.lockUnlockInterface("lock","familySearch",function(){}),self.confirmBox(strLoc.HNLOC_FS_PC_UNLINK_TITLE,strLoc.HNLOC_FS_PC_UNLINK_INDI_MESSAGE,strLoc.HNLOC_FS_OUI,strLoc.HNLOC_FS_NON).then(function(){heredisApi.deleteLinkForIndiHeredis(codeIdHeredis,function(data){heredisApi.markFileAsModified(),heredisApi.markDatabaseChanged(),self.controller.getViewManager().reloadViewAfterLink(),callback(!0)})},function(){callback(!1)}).done(function(){heredisApi.lockUnlockInterface("unlock","familySearch",function(){})})},utils.prototype.linkPrimaryPerson=function(codeIdHeredis,fsid,idUpdate,callback){var self=this,apiHeredis=self.controller.getHeredisApiCall(),viewManager=self.controller.getViewManager();self.IsConnectedToInternet(function(){apiHeredis.linkIndiFSToHeredis(codeIdHeredis,fsid,idUpdate,function(codeId){viewManager.reloadViewAfterLink(),0===parseInt(codeId)?console.log("individu déjà lié"):(console.log("individu lié"),self.controller.getHeredisApiCall().markFileAsModified(),self.controller.getHeredisApiCall().markDatabaseChanged())})})},utils.prototype.confirmBox=function(title,message,okButton,cancelButton){return $("<div></div>").kendoConfirm({title:title,content:message,messages:{okText:okButton,cancel:cancelButton}}).data("kendoConfirm").open().result},utils.prototype.getPrivacyPolicy=function(callback){this.controller.getHeredisApiCall().getUrlPrivacyPolicy("PolicyPolitics",function(url){void 0!==callback&&callback(url)})},utils.prototype.compareEvts=function(a,b){var fsApiCall=this.controller.getFsApiCall(),viewManager=this.controller.getViewManager(),mapIndexOrderFacts=(fsApiCall.typeFactsRelationShips,fsApiCall.indexTypeFacts),mapTypeFactsIndi=fsApiCall.typeFactsPerson,mapTypeKeysFactIndi=Object.keys(mapTypeFactsIndi),mapTypeFactsUnion=fsApiCall.typeFactsRelationShips,mapTypeKeysFactUnion=Object.keys(mapTypeFactsUnion),compare=function(mapKeys,map,typeSection){if("indi"===typeSection)var indexEvt=0,typeEvenement=viewManager.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVENTS_SUB_SECTION_PERSON_TITLE;else if("union"===typeSection)indexEvt=1,typeEvenement=viewManager.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVENTS_SUB_SECTION_COUPLE_TITLE;mapKeys.forEach(function(elt){var found=!1;if(a.forEach(function(fsevt){void 0!==fsevt.type&&fsevt.type===map[elt]&&(found=!0)}),found){var foundInOtherTable=!1;if(b.forEach(function(heredisEvt){void 0!==heredisEvt.type&&heredisEvt.type===map[elt]&&(foundInOtherTable=!0)}),foundInOtherTable);else{var typeEvt=map[elt];b.push({typeEvt:typeEvt,type:" ",date:" ",lieu:" ",category:typeEvenement,index:indexEvt,order:mapIndexOrderFacts[typeEvt]})}}else{foundInOtherTable=!1;if(b.forEach(function(heredisEvt){void 0!==heredisEvt.type&&heredisEvt.type===map[elt]&&(foundInOtherTable=!0)}),foundInOtherTable){typeEvt=map[elt];a.push({typeEvt:typeEvt,type:" ",date:" ",lieu:" ",category:typeEvenement,index:indexEvt,order:mapIndexOrderFacts[typeEvt]})}}})};compare(mapTypeKeysFactIndi,mapTypeFactsIndi,"indi"),compare(mapTypeKeysFactUnion,mapTypeFactsUnion,"union")},utils.prototype.compareRelativesIndi=function(fsRelatives){this.controller.getFsApiCall();var viewManager=this.controller.getViewManager(),heredisApiCall=this.controller.getHeredisApiCall(),fsFamilies=new Array,heredisFamilies=new Array,fieldsParentSpouse={nom:{field:"nom",type:"String"},fsID:{field:"fsID",type:"String"},dateBirth:{field:"dateBirth",type:"String"},dateDeath:{field:"dateDeath",type:"String"}},columnsTabParentSpouse=[{field:"nom",title:"Nom"},{field:"fsID",title:"fsid"},{field:"dateBirth",title:"Date de naissance"},{field:"dateDeath",title:"Date de décès"}],fieldsChildren={nom:{field:"nom",type:"String"},dateBirth:{field:"dateBirth",type:"String"},dateDeath:{field:"dateDeath",type:"String"},pere:{field:"pere",type:"String"},mere:{field:"mere",type:"String"},fsid:{field:"fsID",type:"String"}},columnTabChildren=[{field:"nom",width:"110px",title:"Nom"},{field:"fsid",width:"110px",title:"Fsid"},{field:"dateBirth",title:"Date de naissance"},{field:"dateDeath",title:"Date de décès"},{field:"pere",title:"Père"},{field:"mere",title:"Mère"}],parentsOrderIndex={Masculin:1,"Féminin":2};fsFamilies=[{titre:"Parents",type:"parents",mode:"GET",token:"Bearer "+fsApiClient.getAccessToken(),args:{},urlResource:fsRelatives.parents.href,columnTab:columnsTabParentSpouse,fields:fieldsParentSpouse,callbackSchema:function(resp){var parents=new Array;return void 0!==resp&&resp.persons.forEach(function(elt){var infoIndi={};infoIndi.nom=elt.display.name,infoIndi.fsID=elt.id,infoIndi.dateBirth=elt.display.birthDate,infoIndi.dateDeath=elt.display.deathDate,infoIndi.index=parentsOrderIndex[elt.display.gender],parents.push(infoIndi)}),parents}},{titre:"Conjoints",type:"spouses",mode:"GET",urlResource:fsRelatives.spouses.href,token:"Bearer "+fsApiClient.getAccessToken(),args:{},columnTab:columnsTabParentSpouse,fields:fieldsParentSpouse,callbackSchema:function(resp){var spouses=new Array;return void 0!==resp&&void 0!==resp.persons&&resp.persons.forEach(function(elt){var infoIndi={};infoIndi.nom=elt.display.name,infoIndi.fsID=elt.id,infoIndi.dateBirth=elt.display.birthDate,infoIndi.dateDeath=elt.display.deathDate,infoIndi.index=1,spouses.push(infoIndi)}),spouses}},{titre:" Enfants ",type:"children",mode:"GET",urlResource:fsRelatives.children.href,token:"Bearer "+fsApiClient.getAccessToken(),args:{},columnTab:columnTabChildren,fields:fieldsChildren,callbackSchema:function(resp){var children=new Array;return void 0!==resp&&void 0!==resp.persons&&resp.persons.forEach(function(elt){var infoIndi={};infoIndi.nom=elt.display.name,infoIndi.fsID=elt.id,infoIndi.dateBirth=elt.display.birthDate,infoIndi.dateDeath=elt.display.deathDate,infoIndi.index=1,resp.childAndParentsRelationships.forEach(function(rel){rel.child.resourceId===elt.id&&(void 0!==rel.father&&(infoIndi.pere=rel.father.resourceId),void 0!==rel.mother&&(infoIndi.mere=rel.mother.resourceId))}),children.push(infoIndi)}),children}}],heredisFamilies=[{titre:"Parents",type:"parents",mode:"POST",token:heredisApiCall.ajaxController.getToken(),urlResource:heredisApiCall.ajaxController.getBaseUrl()+"/libheredis/familySearch/getFamilies",args:{uuid:heredisApiCall.ajaxController.uuid,codeIDPC:this.mInfoPC.codeID,codeIDSpouses:this.mInfoPC.codeIdsSpouses,typeRsrc:"parents"},fields:fieldsParentSpouse,columnTab:columnsTabParentSpouse,callbackSchema:function(resp){var parents=new Array;return resp.forEach(function(elt){var indiFormate={};indiFormate.nom=elt.StrNomPrenomsTous,indiFormate.dateBirth=elt.strDateNaissancefd_lun_8_fev_1954,indiFormate.dateDeath=elt.strDateDecesfd_lun_8_fev_1954,indiFormate.fsID=elt.fsID,indiFormate.index=elt.index,parents.push(indiFormate)}),parents}},{titre:"Conjoints",type:"spouses",mode:"POST",token:heredisApiCall.ajaxController.getToken(),urlResource:heredisApiCall.ajaxController.getBaseUrl()+"/libheredis/familySearch/getFamilies",args:{uuid:heredisApiCall.ajaxController.uuid,codeIDPC:this.mInfoPC.codeID,codeIDSpouses:this.mInfoPC.codeIdsSpouses,typeRsrc:"spouses"},fields:fieldsParentSpouse,columnTab:columnsTabParentSpouse,callbackSchema:function(resp){var spouses=new Array;return resp.forEach(function(elt){var indiFormate={};indiFormate.nom=elt.StrNomPrenomsTous,indiFormate.dateBirth=elt.strDateNaissancefd_lun_8_fev_1954,indiFormate.dateDeath=elt.strDateDecesfd_lun_8_fev_1954,indiFormate.fsID=elt.fsID,spouses.push(indiFormate)}),spouses}},{titre:"Enfants",type:"children",mode:"POST",token:heredisApiCall.ajaxController.getToken(),urlResource:heredisApiCall.ajaxController.getBaseUrl()+"/libheredis/familySearch/getFamilies",args:{uuid:heredisApiCall.ajaxController.uuid,codeIDPC:this.mInfoPC.codeID,codeIDSpouses:this.mInfoPC.codeIdsSpouses,typeRsrc:"children"},fields:fieldsChildren,columnTab:columnTabChildren,callbackSchema:function(resp){var children=new Array;return resp.forEach(function(elt){var indiFormate={};indiFormate.nom=elt.StrNomPrenomsTous,indiFormate.dateBirth=elt.strDateNaissancefd_lun_8_fev_1954,indiFormate.dateDeath=elt.strDateDecesfd_lun_8_fev_1954,indiFormate.pere=elt.nomPere,indiFormate.mere=elt.nomMere,indiFormate.fsID=elt.fsID,children.push(indiFormate)}),children}}],viewManager.displayRelationShipCompareView(heredisFamilies,"localIndiRelationshipTab"),viewManager.displayRelationShipCompareView(fsFamilies,"fsIndiRelationshipTab")},utils.prototype.compareEvtIndi=function(factsFs,heredisEventsInfo){var fsApiCall=this.controller.getFsApiCall(),viewManager=this.controller.getViewManager(),mapType=fsApiCall.typeFacts,mapTypeFactsIndi=fsApiCall.typeFactsPerson,mapTypeFactsRelationships=fsApiCall.typeFactsRelationShips,mapIndexOrderFacts=fsApiCall.indexTypeFacts,fields={typeEvt:{field:"date",type:"String"},typeEvt:{field:"lieu",type:"String"}},formatDataEvt=function(evt,typeIndividu){var dataGrid=new Array;return Object.keys(mapType).forEach(function(elt){var type;type=mapType[elt],evt.forEach(function(elt){var date="",lieu="";if(void 0!==elt.date&&void 0!==elt.date.original&&(date=elt.date.original),void 0!==elt.place&&void 0!==elt.place.original&&(lieu=elt.place.original),"fs"===typeIndividu)if(void 0!==mapTypeFactsIndi[elt.type]&&mapTypeFactsIndi[elt.type]===type){var typeEvt=mapTypeFactsIndi[elt.type],indexEvt=0,typeEvenement=viewManager.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVENTS_SUB_SECTION_PERSON_TITLE;dataGrid.push({typeEvt:typeEvt,type:typeEvt,date:date,lieu:lieu,category:typeEvenement,index:indexEvt,order:mapIndexOrderFacts[typeEvt]})}else void 0!==mapTypeFactsRelationships[elt.type]&&mapTypeFactsRelationships[elt.type]===type&&(typeEvt=mapTypeFactsIndi[elt.type],indexEvt=1,typeEvenement=viewManager.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVENTS_SUB_SECTION_COUPLE_TITLE,dataGrid.push({typeEvt:typeEvt,type:typeEvt,date:date,lieu:lieu,category:typeEvenement,index:indexEvt,order:mapIndexOrderFacts[typeEvt]}));else"heredis"===typeIndividu&&void 0!==elt.type&&elt.type===type&&dataGrid.push({typeEvt:elt.type,type:elt.type,date:date,lieu:lieu,category:elt.typeEvenement,index:elt.indexEvt,order:mapIndexOrderFacts[elt.type]})})}),dataGrid},dataGridFs=formatDataEvt(factsFs,"fs"),dataGridHeredis=formatDataEvt(heredisEventsInfo,"heredis");this.compareEvts(dataGridFs,dataGridHeredis),remoteDataEvtOptionFs={type:"evt",mode:"GET",tokenFs:"Bearer "+fsApiClient.getAccessToken(),columns:[{field:"type",title:"Type"},{field:"date",title:"Date"},{field:"lieu",title:"Lieu"},{field:"index",groupHeaderTemplate:'<span class="section" data-container="fsIndiEvtTab" data-type="#= items[0].typeEvt #" >#=items[0].category#</span>',hidden:!0}],data:dataGridFs},remoteDataEvtOptionHeredis={type:"evt",mode:"POST",columns:[{field:"type",title:"Type"},{field:"date",title:"Date"},{field:"lieu",title:"Lieu"},{field:"index",groupHeaderTemplate:'<span class="section" data-container="localIndiEvtTab" data-type="#= items[0].typeEvt #" >#=items[0].category#</span>',hidden:!0}],data:dataGridHeredis},viewManager.displayEventsCompareView(remoteDataEvtOptionFs,"fsIndiEvtTab",fields),viewManager.displayEventsCompareView(remoteDataEvtOptionHeredis,"localIndiEvtTab",fields)},utils.prototype.getEventsOfIndi=function(data){var events=new Array,viewManager=this.controller.getViewManager();if(""===data.pc.dateNaissance&&""===data.pc.lieuNaissance);else{var naissance={order:1,typeEvenement:viewManager.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVENTS_SUB_SECTION_PERSON_TITLE,typeEvt:"indi",indexEvt:0,type:"naissance",date:{original:"-"},place:{original:"-"}};naissance.date.original=data.pc.dateNaissance,naissance.place.original=data.pc.lieuNaissance,events.push(naissance)}if(""===data.pc.dateDeces&&""===data.pc.lieuDeces);else{var deces={order:2,typeEvenement:viewManager.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVENTS_SUB_SECTION_PERSON_TITLE,typeEvt:"indi",indexEvt:0,type:"deces",date:{original:"-"},place:{original:"-"}};deces.date.original=data.pc.dateDeces,deces.place.original=data.pc.lieuDeces,events.push(deces)}return data.pc.unions.length>0&&data.pc.unions.forEach(function(elt,index){var union={order:index,typeEvenement:viewManager.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVENTS_SUB_SECTION_COUPLE_TITLE,typeEvt:"union",indexEvt:1,type:elt.typeUnion,date:{original:"-"},place:{original:"-"}};""!==elt.dateUnion&&(union.date={original:elt.dateUnion}),""!==elt.lieuUnion&&(union.place={original:elt.lieuUnion}),events.push(union)}),events};