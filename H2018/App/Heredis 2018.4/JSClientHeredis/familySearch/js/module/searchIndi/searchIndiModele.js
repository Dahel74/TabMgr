function searchIndiModele(searchController){this.searchController=searchController,this.aux=searchController.aux,this.mainController=searchController.viewUtilsController,this.apiHeredis=searchController.viewUtilsController.controller.getHeredisApiCall(),this.apiFs=searchController.viewUtilsController.controller.getFsApiCall()}searchIndiModele.prototype.searchController=null,searchIndiModele.prototype.mainController=null,searchIndiModele.prototype.apiHeredis=null,searchIndiModele.prototype.apiFs=null,searchIndiModele.prototype.aux=null,searchIndiModele.prototype.currentSearch=null,searchIndiModele.prototype.getSearchResultCallback=function(newSearch,response){var self=this;self.currentSearch=response.data;var searchResults=new Array,compteur=0,totalResults=0;void 0!==response.data&&void 0!==response.data.results&&(totalResults=response.data.searchInfo[0].closeHits);var getInfosCallback=function(index,entries){index===entries.length?self.searchController.displaySearchResult(newSearch,searchResults,response.data.index,totalResults):entries[index].content.gedcomx.persons.forEach(function(elt){if(elt.id===entries[index].id){var infoIndi=elt.display;infoIndi.confidence=entries[index].confidence,infoIndi.idIndi=entries[index].id,infoIndi.score=entries[index].score,searchResults.push(infoIndi),getInfosCallback(++compteur,entries)}})};if(void 0!==response&&void 0!==response.data){if(void 0!==response.data.entries){var res=response.data.entries;if(res.length>0){var fsStr=JSON.stringify(res);self.apiHeredis.formatJSON(encodeURIComponent(fsStr),function(newData){getInfosCallback(0,newData)})}else self.searchController.displaySearchResult(newSearch,searchResults,response.data.index,totalResults)}}else self.searchController.displaySearchResult(newSearch,searchResults,0,totalResults)},searchIndiModele.prototype.FillPCFieldCallback=function(infosPC,callback){null===infosPC?this.aux.getInfosPC(this.apiHeredis,this.searchController,this.searchController.fillPCForm,callback):this.searchController.fillPCForm(this.searchController,infosPC,callback)},searchIndiModele.prototype.searchByPCCallback=function(stateForm){var self=this;this.mainController.showLoadingText("#searchResult","HNLOC_FS_LOADING_TEXT_SEARCH");var infosPC=self.searchController.getInfosPCFromSearchForm(stateForm);this.apiFs.searchPC(infosPC,function(isNewSearch,data){self.getSearchResultCallback(isNewSearch,data)},function(errorCode){self.searchController.internalServerErrorForm(errorCode)})},searchIndiModele.prototype.callbackClickRow=function(personID,name){var self=this;self.apiFs.getJSONFamiliesOfPersonId(personID,function(a,resp){self.apiHeredis.showFSIndiSummary(JSON.stringify(resp),name,function(){})})},searchIndiModele.prototype.compareButtonSearchCallback=function(){var self=this,viewManager=this.mainController;$(".buttonCompare").click(function(e){viewManager.showLoadingText("");var stateForm=self.aux.getStateForm(),infos=self.searchController.getInfosPCFromSearchForm(stateForm);self.aux.saveFormSearchPCContent(infos),self.aux.IsConnectedToInternet(function(){self.apiFs.getPersonById($(e.target).data("personid"),function(a,resp){self.aux.compareIndiModele=new compareIndiModele(self.aux,self.apiFs,self.apiHeredis),self.aux.compareIndiModele.getFamilyOfIndiFs($(e.target).data("personid"),resp.etag,function(heredisTreePerson,fsTreePersons){var heredisFamilytree,fsFamilyTree;heredisFamilytree=heredisTreePerson,fsFamilyTree=fsTreePersons,viewManager.primaryPersonController.compareIndiController.displayCompareIndiTreeView(fsFamilyTree,heredisFamilytree,"",function(){viewManager.disableLoadingText("")})})},function(errorCode,pid){self.searchController.internalServerErrorForm(errorCode,pid)})})})},searchIndiModele.prototype.searchPC=function(callback){var self=this;this.aux.IsConnectedToInternet(function(){var stateForm=self.getStateForm();self.searchByPCCallback(stateForm)})},searchIndiModele.prototype.getStateForm=function(){return this.aux.getStateForm()},searchIndiModele.prototype.getMoreResults=function(){var self=this;void 0!==self.currentSearch.links&&void 0!==self.currentSearch.links.next&&self.aux.IsConnectedToInternet(function(){self.apiFs.getUrl("nextPageSearch",self.currentSearch.links.next.href,function(newData,data){self.getSearchResultCallback(newData,data)},function(errorCode){self.searchController.internalServerErrorForm(errorCode)})})},searchIndiModele.prototype.isNextPageSearchEmpty=function(callback){var self=this;void 0!==self.currentSearch.links&&void 0!==self.currentSearch.links.next&&self.aux.IsConnectedToInternet(function(){self.apiFs.getUrl("nextPageSearch",self.currentSearch.links.next.href,function(newData,data){204===data.statusCode?callback(!0):200===data.statusCode&&callback(!1)},function(errorCode){self.searchController.internalServerErrorForm(errorCode)})})};