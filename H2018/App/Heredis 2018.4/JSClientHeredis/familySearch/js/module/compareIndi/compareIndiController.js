function compareIndiController(viewUtilsController){this.viewUtilsController=viewUtilsController,this.mainController=viewUtilsController.controller,this.stringsLocalised=viewUtilsController.stringsLocalised,this.compareIndiModele=viewUtilsController.aux.compareIndiModele,this.aux=viewUtilsController.aux,this.sexeEnumSosa={63:"../Common/Resources/sexe/iconFe/ico-sex-ind-sosa.png",102:"../Common/Resources/sexe/iconFe/ico-sex-fem-sosa.png",109:"../Common/Resources/sexe/iconFe/ico-sex-hom-sosa.png"},this.sexeEnum={63:"../Common/Resources/sexe/iconFe/ico-sex-ind.png",102:"../Common/Resources/sexe/iconFe/ico-sex-fem.png",109:"../Common/Resources/sexe/iconFe/ico-sex-hom.png"},this.sexeEnumStrings={102:this.stringsLocalised.HNLOC_FS_SEXE_F,109:this.stringsLocalised.HNLOC_FS_SEXE_M,63:this.stringsLocalised["HNLOC_FS_SEXE_?"]}}compareIndiController.prototype.viewUtilsController=null,compareIndiController.prototype.mainController=null,compareIndiController.prototype.stringsLocalised=null,compareIndiController.prototype.aux=null,compareIndiController.prototype.listCompareModel=null,compareIndiController.prototype.treeCompareModel=null,compareIndiController.prototype.compareIndiModele=null,compareIndiController.prototype.sexeEnumSosa=null,compareIndiController.prototype.sexeEnum=null,compareIndiController.prototype.displayCompareIndiTreeView=function(fsIndi,heredisIndi,containerId,callback){var self=this,idContainer=void 0!==containerId&&containerId.length>0?"#"+containerId:"#modalMainPage";self.viewUtilsController.htmlTemplates.getHtmlFileTemplate("html/treeCompare.html",idContainer,function(){self.treeCompareModel=kendo.observable({isViewForUnexistingPersonVisible:!1,textViewForUnexistingPersonPart1:self.stringsLocalised.HNLOC_FS_COMPARE_UNEXISTING_PERSON_TEXT_PART1,textViewForUnexistingPersonPart2:self.stringsLocalised.HNLOC_FS_COMPARE_UNEXISTING_PERSON_TEXT_PART2.replace("%fsid",fsIndi.root.personID),textViewForUnexistingPersonPart3:self.stringsLocalised.HNLOC_FS_COMPARE_UNEXISTING_PERSON_TEXT_PART3,leftSectionTitle:self.stringsLocalised.HNLOC_FS_COMPARE_SECTION_HEREDIS_TITLE,leftSectionfirstListTitle:self.stringsLocalised.HNLOC_FS_SPOUSES,leftSectionSecondListTitle:self.stringsLocalised.HNLOC_FS_CHILDREN,rightSectionTitle:self.stringsLocalised.HNLOC_FS_COMPARE_SECTION_FS_TITLE,rightSectionFirstListTitle:self.stringsLocalised.HNLOC_FS_SPOUSES,rightSectionSecondListTitle:self.stringsLocalised.HNLOC_FS_CHILDREN,dateBDFatherLeftSection:heredisIndi.parents.father.strNaisDecesCourtWithPrivate,namePidFatherLeftSection:heredisIndi.parents.father.namePid,fatherLeftPersonID:heredisIndi.parents.father.codeId,fatherLeftIconSexe:self.getIconSexeIndividuSosa(heredisIndi.parents.father.isSosa,heredisIndi.parents.father.sexe),isFatherLeftExist:self.isIndividuExist(heredisIndi.parents.father.codeId),namePidMotherLeftSection:heredisIndi.parents.mother.namePid,dateBDMotherLeftSection:heredisIndi.parents.mother.strNaisDecesCourtWithPrivate,motherLeftPersonID:heredisIndi.parents.mother.codeId,motherLeftIconSexe:self.getIconSexeIndividuSosa(heredisIndi.parents.mother.isSosa,heredisIndi.parents.mother.sexe),isMotherLeftExist:self.isIndividuExist(heredisIndi.parents.mother.codeId),namePidPCLeftSection:heredisIndi.root.namePid,birthDatePlacePcLeftSection:heredisIndi.root.strBirthPlaceDate,deathDatePlacePcLeftSection:heredisIndi.root.strDeathPlaceDate,pcLeftPersonID:heredisIndi.root.codeId,pcLeftIconSexe:self.getIconSexeIndividuSosa(heredisIndi.root.isSosa,heredisIndi.root.sexe),isPcLeftExist:self.isIndividuExist(heredisIndi.root.codeId),namePidPCRightSection:fsIndi.root.namePid,birthDatePlacePcRightSection:fsIndi.root.strBirthPlaceDate,deathDatePlacePcRightSection:fsIndi.root.strDeathPlaceDate,pcRightPersonIDPlusName:fsIndi.root.personID+"|"+fsIndi.root.mainName,pcRightPersonID:fsIndi.root.personID,pcRightIconSexe:fsIndi.root.gender,isPcRightExist:self.isIndividuExist(fsIndi.root.personID),namePidFatherRightSection:fsIndi.parents.father.namePid,dateBDFatherRightSection:fsIndi.parents.father.dateND,fatherRightPersonIDPlusName:fsIndi.parents.father.personID+"|"+fsIndi.parents.father.mainName,fatherRightIconSexe:fsIndi.parents.father.gender,isFatherRightExist:self.isIndividuExist(fsIndi.parents.father.personID),namePidMotherRightSection:fsIndi.parents.mother.namePid,dateBDMotherRightSection:fsIndi.parents.mother.dateND,motherRightPersonIDPlusName:fsIndi.parents.mother.personID+"|"+fsIndi.parents.mother.mainName,motherRightIconSexe:fsIndi.parents.mother.gender,isMotherRightExist:self.isIndividuExist(fsIndi.parents.mother.personID),returnButtonText:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_BUTTON_RETURN_LABEL,compareShowBtnReturn:"#modalMainPage"===idContainer,linkIndiButtonText:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_BUTTON_LINK_LABEL,compareShowBtnLink:"#modalMainPage"===idContainer,unlinkIndiButtonText:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_BUTTON_UNLINK_LABEL,compareShowBtnUnlink:"#modalMainPage"!==idContainer,clickIndiAction:function(e){var chaines=$(e.currentTarget).attr("name").split("|");chaines.length>1?self.viewUtilsController.aux.compareIndiModele.getResumeIndiFs(self.viewUtilsController.aux.compareIndiModele,chaines[0],chaines[1]):self.viewUtilsController.aux.compareIndiModele.getResumeIndiHeredis(self.viewUtilsController.aux.compareIndiModele,chaines[0])},returnAction:function(){"#modalMainPage"===idContainer&&self.viewUtilsController.hideFullScreenModal()},linkIndiAction:function(e){self.aux.linkPrimaryPerson(this.get("pcLeftPersonID"),this.get("pcRightPersonID"),self.aux.compareIndiModele.idUpdateIndiFs)},unlinkIndiAction:function(e){self.aux.unlinkPrimaryPerson(this.get("pcLeftPersonID"),function(didUnlink){"#modalMainPage"===idContainer&&!0===didUnlink&&self.viewUtilsController.hideFullScreenModal()})}}),fsIndi.children.forEach(function(element){self.addChildren(element,"#childrenRightSection","fs")}),heredisIndi.children.forEach(function(element){element.isSosa?element.gender=self.sexeEnumSosa[element.sexe]:element.gender=self.sexeEnum[element.sexe],self.addChildren(element,"#childrenLeftSection","heredis")}),fsIndi.spouses.forEach(function(element){self.addSpouse(element,"#spousesRightSection","fs")}),heredisIndi.spouses.forEach(function(element){element.isSosa?element.gender=self.sexeEnumSosa[element.sexe]:element.gender=self.sexeEnum[element.sexe],self.addSpouse(element,"#spousesLeftSection","heredis")}),kendo.bind($(idContainer),self.treeCompareModel),fsIndi.found?(self.treeCompareModel.set("isViewForUnexistingPersonVisible",!1),$("#containerIndiFs").css("opacity","1"),$("#containerIndiFs").removeAttr("disabled")):(self.treeCompareModel.set("isViewForUnexistingPersonVisible",!0),$("#containerIndiFs").css("opacity","0.4"),$("#containerIndiFs").attr("disabled","disabled")),"#modalMainPage"===idContainer?(self.viewUtilsController.showFullScreenModal(),$("#containerIndiSections").css("height","calc(100vh - 46px)")):$("#containerIndiSections").css("height","calc(100vh - 173px)"),void 0!==callback&&callback(heredisIndi,fsIndi)})},compareIndiController.prototype.displayCompareIndiListView=function(fsIndi,heredisIndi,callback){var self=this;this.aux.idSpousesPC=heredisIndi.codeIdsSpouses,self.viewUtilsController.htmlTemplates.getHtmlFileTemplate("html/listCompare.html","#modalMainPage",function(){self.listCompareModel=kendo.observable({persoInfoSectionTitle:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_INFOSPERSOS_SECTION_TITLE,persoEvtSectionTitle:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_EVT_SECTION_TITLE,persoFamilySectionTitle:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_FAMILY_SECTION_TITLE,returnButtonText:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_BUTTON_RETURN_LABEL,linkIndiButtonText:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_BUTTON_LINK_LABEL,unlinkIndiButtonText:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_BUTTON_UNLINK_LABEL,discussionButtonText:self.stringsLocalised.HNLOC_FS_COMPARE_VIEW_BUTTON_DISCUSSIONS_LABEL,nameHeredisIndi:heredisIndi.givenName+" "+heredisIndi.surname,genderHeredisIndi:self.sexeEnumStrings[heredisIndi.sexe],nameFsIndi:fsIndi.name,genderfsIndi:fsIndi.gender,isReturnButtonVisible:!0,isLinkIndiButtonVisible:!0,isUnlinkIndiButtonVisible:!0,returnAction:function(){self.viewUtilsController.hideFullScreenModal(),self.compareIndiModele.deleteToken()},linkIndiAction:function(){self.aux.linkIndiFSToHeredis()},unlinkIndiAction:function(){},discussionAction:function(){}}),kendo.bind($("#modalMainPage"),self.listCompareModel),self.viewUtilsController.showFullScreenModal(),void 0!==callback&&callback()})},compareIndiController.prototype.addChildren=function(child,idContainer,typeIndi){var hideNbLit="";void 0!==child.numeroLit&&""!==child.numeroLit||(hideNbLit=' style="display:none" '),"heredis"===typeIndi?nameAttrTemplate="#= codeId #":"fs"===typeIndi&&(nameAttrTemplate="#= personID #|#= mainName  #");var chiildrenTemplate='<div class="caseEnfant"  name="'+nameAttrTemplate+'" data-bind="click: clickIndiAction"><div style="width:100%;margin-top:0px;"><img src="#= gender #" class="iconSexe"><span class="nom" title="#= nameTp #">#= namePid #</span></div><div style="width:100%;margin-top:2px;"><span class="date">#=dateND #</span><span class="nbLit"'+hideNbLit+">#= numeroLit #</span></div></div>",template=kendo.template(chiildrenTemplate);$(idContainer).append(template(child))},compareIndiController.prototype.addSpouse=function(spouse,idContainer,typeIndi){var hideNbLit="";void 0!==spouse.numeroLit&&""!==spouse.numeroLit||(hideNbLit=' style="display:none" '),"heredis"===typeIndi?nameAttrTemplate="#= codeId #":"fs"===typeIndi&&(nameAttrTemplate="#= personID #|#= mainName  #");var spouseTemplate='<div class="caseConjoint"  name="'+nameAttrTemplate+'" data-bind="click: clickIndiAction"><div style="width:100%;margin-top:0px;"><img src="#= gender #" class="iconSexe"><span class="nom" title="#= nameTp #">#= namePid #</span></div><div style="width:100%;margin-top:2px;"><span class="date">#=dateND #</span><span class="nbLit"'+hideNbLit+'>#= numeroLit #</span></div><div style="width:100%;margin-top:2px;"><img src="../Common/Resources/alliances.png" class="iconeUnion"><span class="dateUnion">#= unionDate #</span></div></div>',template=kendo.template(spouseTemplate);$(idContainer).append(template(spouse))},compareIndiController.prototype.getIconSexeIndividuSosa=function(isSosa,sexeId){return isSosa?this.sexeEnumSosa[sexeId]:this.sexeEnum[sexeId]},compareIndiController.prototype.isIndividuExist=function(idIndi){return 0!==idIndi&&""!==idIndi};