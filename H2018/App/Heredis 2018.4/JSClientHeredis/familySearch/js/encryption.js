function EncryptionUtils(secret){this.secretPassPhrase=secret}EncryptionUtils.prototype.secretPassPhrase=null,EncryptionUtils.prototype.encryptPasswdAES128CBC=function(p,scope){var salt=CryptoJS.lib.WordArray.random(16),iv=CryptoJS.lib.WordArray.random(16),key128Bits=CryptoJS.PBKDF2(this.secretPassPhrase,salt,{keySize:4}),ciphertext=CryptoJS.AES.encrypt(p,key128Bits,{iv:iv});CryptoJS.lib.WordArray.create().init(ciphertext.iv.words),"persistent"===scope?(this.saveItemInCookie("salt",JSON.stringify(salt.words)),this.saveItemInCookie("pwd",ciphertext.toString()),this.saveItemInCookie("iv",JSON.stringify(iv.words))):"session"===scope&&(this.saveInLocalStorage("salt",JSON.stringify(salt.words)),this.saveInLocalStorage("pwd",ciphertext.toString()),this.saveInLocalStorage("iv",JSON.stringify(iv.words)))},EncryptionUtils.prototype.decryptPasswdAES128CBC=function(p,scope){var ivb=CryptoJS.lib.WordArray.create(),saltb=CryptoJS.lib.WordArray.create();"persistent"===scope?(ivb.init(JSON.parse(this.getItemInCookie("iv"))),saltb.init(JSON.parse(this.getItemInCookie("salt")))):"session"===scope&&(ivb.init(JSON.parse(this.getFromLocalStorage("iv"))),saltb.init(JSON.parse(this.getFromLocalStorage("salt"))));var key=CryptoJS.PBKDF2(this.secretPassPhrase,saltb,{keySize:4});return CryptoJS.AES.decrypt(p,key,{iv:ivb}).toString(CryptoJS.enc.Utf8)},EncryptionUtils.prototype.getKeyFromSecretPhrase=function(phrase){var salt=CryptoJS.lib.WordArray.random(16);return CryptoJS.PBKDF2(this.secretPassPhrase,salt,{keySize:4})},EncryptionUtils.prototype.saveItemInCookie=function(name,value){$.cookie(name,value,{expires:365})},EncryptionUtils.prototype.removeCookieLogin=function(){$.removeCookie("username"),$.removeCookie("pwd"),$.removeCookie("key128Bits")},EncryptionUtils.prototype.getItemInCookie=function(name){var resp="";return void 0!==$.cookie(name)&&(resp=$.cookie(name)),resp},EncryptionUtils.prototype.saveInLocalStorage=function(name,value){localStorage.setItem(name,value)},EncryptionUtils.prototype.getFromLocalStorage=function(name){var resp="undefined";return null!==localStorage.getItem(name)&&(resp=localStorage.getItem(name)),resp};