function WikiApi(){var date,urlApi,months=new Array,idPage=0;this.init=function(langue){date=new Date,"fr"===langue&&(months[0]="janvier",months[1]="février",months[2]="mars",months[3]="avril",months[4]="mai",months[5]="juin",months[6]="juillet",months[7]="août",months[8]="septembre",months[9]="octobre",months[10]="novembre",months[11]="décembre",urlApi="https://fr.wikipedia.org/w/api.php")};var ParseResult=function(idPage,url,index,type,widget,page,AllData,callback){$.ajax({url:url,data:{action:"query",pageids:idPage,format:"json",prop:"revisions",rvprop:"content",rvsection:index,rvparse:""},dataType:"jsonp",type:"POST",success:function(data){var contenuText=$.parseHTML(data.query.pages[idPage].revisions[0]["*"]);if("prenom"===type){for(var prenom=widget.find("#prenoms"),noms=$(contenuText).find("a"),a=0;a<noms.length;a++)(void 0!==$(noms[a]).attr("class")&&"mw-disambig"===$(noms[a]).attr("class")||void 0!==$(noms[a]).attr("title")&&$(noms[a]).attr("title").indexOf("prénom")>-1||void 0!==$(noms[a]).attr("href")&&$(noms[a]).attr("href").indexOf("pr%C3%A9nom")>-1)&&prenom.length<4&&-1===$(noms[a]).text().indexOf(" ")&&prenom.append("<p> "+$(noms[a]).text()+" </p>");callback(AllData)}else if("dicton"===type){var many=!1,dicton=widget.find("#dictons");for(a=0;a<$(contenuText).length;a++)"ul"!==$(contenuText)[a].nodeName&&"UL"!==$(contenuText)[a].nodeName||(many=!0);if(!1===many)for(var b=0;b<$(contenuText).length;b++)"#text"===$(contenuText)[b].nodeName&&dicton.append($(contenuText)[b].data);else{var maxDictons=4,dictons=$(contenuText).find("li");dictons.length<maxDictons&&(maxDictons=$(contenuText).length);for(var c=0;c<maxDictons;c++)$(dictons[c]).find("sup").remove(),dicton.append("<p>"+$(dictons[c]).text()+"</p>")}callback(widget)}}})};this.getEphemeride=function(cache,context,data,page,callback){if(void 0===cache.ephemeride||void 0!==cache.ephemeride&&cache.ephemeride.date!==date.getDate()+"_"+months[date.getMonth()]){kendo.ui.progress($(context).find(".contenu"),!0);var widgetEphemeride='<div class="prenomsContainer stats"><div class="ephEntete k-shadow "> Prénoms du jour </div><div class="ephContent" id="prenoms"></div></div><div class="dictonsContainer stats"><div class="ephEntete k-shadow"> Dictons du jour </div><div class="ephContent" id="dictons"></div></div><div class="stats"><div class="ephEntete k-shadow"><a target="_blank" style="color:black" href="https://fr.wikipedia.org/wiki/'+date.getDate()+"_"+months[date.getMonth()]+'">'+localisedString.HNLOC_DASH_EPHEMERIDE_SOURCE_URL+"</a></div></div>";if(navigator.onLine){var jour=date.getDate();1===jour&&(jour="1er"),function(page,url,widget,currentpage,callback){$.ajax({url:url,data:{action:"parse",page:page,format:"json"},dataType:"jsonp",type:"POST",success:function(data){if(idPage=data.parse.pageid,0===data.parse.sections.length)callback(widget);else for(var a=0;a<data.parse.sections.length;a++)if("Prénoms"===data.parse.sections[a].line||"Prénoms du jour"===data.parse.sections[a].line||"Prénom du jour"===data.parse.sections[a].line){ParseResult(idPage,url,data.parse.sections[a].index,"prenom",widget,currentpage,data,function(data){for(var a=0;a<data.parse.sections.length;a++)if("Dictons du jour"===data.parse.sections[a].line||"Dicton du jour"===data.parse.sections[a].line||"Dictons"===data.parse.sections[a].line||"Dicton"===data.parse.sections[a].line){ParseResult(idPage,url,data.parse.sections[a].index,"dicton",widget,currentpage,data,callback);break}});break}},error:function(jqXHR,textStatus,errorThrown){console.log("session expiré")}})}(jour+"_"+months[date.getMonth()],urlApi,$(widgetEphemeride),page,function(widget){$(context).html(widgetEphemeride),$(context).find(".prenomsContainer").html($(widget[0]).html()),$(context).find(".dictonsContainer").html($(widget[1]).html());var dataEph={};dataEph.datas=$(context).html(),dataEph.date=date.getDate()+"_"+months[date.getMonth()],cache.ephemeride=dataEph,callback(!0)})}else $(context).html('<span class="noInternetDefaultMsg">'+localisedString.HNLOC_DASH_NOINTERNET+"</span>")}else $(context).html($(cache.ephemeride.datas)),callback(!1)}}